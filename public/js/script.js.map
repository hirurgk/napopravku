{"version":3,"sources":["init.js","Doctor.js","Calendar.js","Record.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"script.js","sourcesContent":["$(function(){\r\n\tDoctor.init();\r\n\tCalendar.init();\r\n\tRecord.init();\r\n});","Doctor = {\r\n\tselectedId: 0,\r\n\t\r\n\tinit: function() {\r\n\t\tthis.selectDoctor();\r\n\t},\r\n\t\r\n\t//Выбор врача\r\n\tselectDoctor: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$(\".table-doctors tr\").click(function(){\r\n\t\t\t$(\".table-doctors tr\").removeClass('bg-success');\r\n\t\t\t$(this).addClass('bg-success');\r\n\t\t\t\r\n\t\t\t$this.selectedId = $(this).data('id');\r\n\t\t\t\r\n\t\t\tRecord.getTime($this.selectedId, Calendar.selectedDate);\r\n\t\t});\r\n\t},\r\n}","Calendar = {\r\n\tnow: new Date(),\r\n\tselectedDate: '0000-00-00',\r\n\t\r\n\tinit: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$(\"#calendar\").calendarWidget();\r\n\t\t\r\n\t\tthis.selectDay();\r\n\t},\r\n\t\r\n\t//Следующий месяц\r\n\tnextMonth: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$this.now = new Date($this.now.getYear()+1900, $this.now.getMonth()+1, $this.now.getDate());\r\n\t\t\r\n\t\t$(\"#calendar\").fadeOut(200, function(){\r\n\t\t\t$(\"#calendar\").html('');\r\n\t\t\t\r\n\t\t\t$(\"#calendar\").calendarWidget({\r\n\t\t\t\tmonth: $this.now.getMonth(),\r\n\t\t\t\tyear: $this.now.getYear()+1900\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$(\"#calendar\").fadeIn(200);\r\n\t\t});\r\n\t},\r\n\t\r\n\t//Предыдущий месяц\r\n\tprevMonth: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t//Запрет выбора предыдущего месяца\r\n\t\tvar now = new Date();\r\n\t\tif (now.getYear() == $this.now.getYear() && now.getMonth() == $this.now.getMonth())\r\n\t\t\treturn false;\r\n\t\t\r\n\t\t$this.now = new Date($this.now.getYear()+1900, $this.now.getMonth()-1, $this.now.getDate());\r\n\t\t\r\n\t\t$(\"#calendar\").fadeOut(200, function(){\r\n\t\t\t$(\"#calendar\").html('');\r\n\t\t\t\r\n\t\t\t$(\"#calendar\").calendarWidget({\r\n\t\t\t\tmonth: $this.now.getMonth(),\r\n\t\t\t\tyear: $this.now.getYear()+1900\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$(\"#calendar\").fadeIn(200);\r\n\t\t});\r\n\t},\r\n\t\r\n\t//Выбор дня\r\n\tselectDay: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$(\"body\").on(\"click\", \"#calendar td:not(.old-day)\", function(){\r\n\t\t\t$(\"#calendar td\").removeClass('bg-success');\r\n\t\t\t$(this).addClass('bg-success');\r\n\t\t\t\r\n\t\t\t$this.selectedDate = $(this).data('date');\r\n\t\t\t\r\n\t\t\tRecord.getTime(Doctor.selectedId, $this.selectedDate);\r\n\t\t});\r\n\t},\r\n}","Record = {\r\n\tselectedId: 0,\r\n\tselectedDate: '0000-00-00',\r\n\t\r\n\tinit: function() {\r\n\t\tthis.initModal();\r\n\t\tthis.initSend();\r\n\t},\r\n\t\r\n\t//Получение списка записей\r\n\tgetTime: function(id, date) {\r\n\t\t$this = this;\r\n\t\t\r\n\t\tif (id > 0 && date != '0000-00-00')\r\n\t\t{\r\n\t\t\t$this.selectedId = id;\r\n\t\t\t$this.selectedDate = date;\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: '/list/' + id + '/' + date,\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\tsuccess: function(response){\r\n\t\t\t\t\t$(\"#records\").fadeOut(200, function(){\r\n\t\t\t\t\t\t$(\"#records\").html(response).fadeIn(200);\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\t//Перезагрузка списка записей\r\n\treload: function() {\r\n\t\tthis.getTime($this.selectedId, $this.selectedDate);\r\n\t},\r\n\t\r\n\t//Открытие модального окна с формой для записи\r\n\tinitModal: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$(\"body\").on(\"click\", \"#table-records tr:not(.bg-danger)\", function(){\r\n\t\t\t$this.hideErrors();\r\n\t\t\t\r\n\t\t\tvar time = $(this).find('td:first-child').html();\r\n\t\t\t$(\".record-modal #user-time\").val(time);\r\n\t\t\t\r\n\t\t\t//Маска ввода телефона\r\n\t\t\t$(\"#user-phone\").inputmask(\"+7(999)999-99-99\");\r\n\t\t});\r\n\t},\r\n\t\r\n\t//Запись\r\n\tinitSend: function() {\r\n\t\tvar $this = this;\r\n\t\t\r\n\t\t$(\"body\").on(\"submit\", \".record-modal form\", function(){\r\n\t\t\tvar data = $(this).serialize();\r\n\t\t\tdata += \"&doctor_id=\" + Doctor.selectedId;\r\n\t\t\tdata += \"&time_of_reception=\" + Calendar.selectedDate + \" \" + $(\"#user-time\").val() + \":00\";\r\n\t\t\t\r\n\t\t\t$this.hideErrors();\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: '/store',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content'),\r\n\t\t\t\t},\r\n\t\t\t\tdata: data,\r\n\t\t\t\tmethod: \"POST\",\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tcomplete: function(response) {\r\n\t\t\t\t\tvar json = response.responseJSON;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (response.statusText != \"OK\") {\r\n\t\t\t\t\t\t//Выводим сообщения об ошибке\r\n\t\t\t\t\t\tfor (i in json) {\r\n\t\t\t\t\t\t\t$(\".record-modal .record-errors\").append(\"<li>\" + json[i] + \"</li>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$(\".record-modal .record-errors\").fadeIn(200);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//Успех\r\n\t\t\t\t\t\t$(\".record-modal .record-form\").remove();\r\n\t\t\t\t\t\t$(\".record-modal .record-success\").fadeIn(200);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//При закрытии окна, перезагрузим список записей\r\n\t\t\t\t\t\t$('.record-modal').on('hidden.bs.modal', function (){\r\n\t\t\t\t\t\t\t$this.reload();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\treturn false;\r\n\t\t});\r\n\t},\r\n\t\r\n\t//Прячем сообщения об ошибках\r\n\thideErrors: function() {\r\n\t\t$(\".record-modal .record-errors\").html(\"\").hide();\r\n\t},\r\n}"]}